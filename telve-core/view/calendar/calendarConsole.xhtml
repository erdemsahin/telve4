<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:t="http://java.sun.com/jsf/composite/telveComponents"
                template="/layout/primeTemplate.xhtml">

    <ui:param name="showListBar" value="true" />

    <ui:define name="outerspace">
        <ui:remove>
            <ui:include src="/layout/ajaxLoadingPopup.xhtml" />
        </ui:remove>
        <ui:insert name="includes" />

        <p:dialog id="calendarFilterPopup"  header="#{messages['module.caption.CalendarFilterPopup']}" widgetVar="calendarFilterPopup" modal="true" width="420" height="300">

            <h:form id="filterPopup">

                <div class="row">

                    <t:inputAny label="calendar.label.EventSources" columnClass="col-xs-12">

                        <p:selectManyMenu id="advanced" value="#{calendarFilterModel.calendarSources}" 
                                          var="t" filter="true" filterMatchMode="contains" showCheckbox="true">
                            <f:selectItems value="#{calendarFilterModel.getRegisteredEventSources()}" var="es" itemLabel="#{messages[ 'calendar.source.name.'.concat( es ) ]}" itemValue="#{es}" />

                            <p:column>
                                <h:outputText styleClass="" value=" " />
                            </p:column>

                            <p:column>
                                <h:outputText value="#{messages[ 'calendar.source.name.'.concat( t ) ]}" />
                            </p:column>
                        </p:selectManyMenu>

                    </t:inputAny>


                </div>
                <div class="actionButtons" style="position: absolute;  width: 95%; bottom: 18px; padding-right: 18px;" >
                    <p:commandButton id="select" value="#{messages['general.button.Ok']}" icon="ui-icon-check" ajax="true" process="@form" partialSubmit="false" oncomplete="PF('telveCalendar').update();PF('calendarFilterPopup').hide();"/>
                    <p:button id="close" value="#{messages['general.button.Cancel']}" icon="ui-icon-close" onclick="PF('calendarFilterPopup').hide();"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>

    <h:form id="actionForm">
        <p:remoteCommand name="newEvent"  actionListener="#{calendarHome.newEvent}" />
        <p:remoteCommand name="editEvent" actionListener="#{calendarHome.editEvent}" />
    </h:form>


    <ui:define name="body">


        <ui:include src="/layout/messages.xhtml"/>

        <div class="box">
            <div class="box-body no-padding">
                <h:form>
                    <p:schedule id="schedule" value="#{calendarHome.model}" widgetVar="telveCalendar" timeZone="GMT+2" rightHeaderTemplate="" tooltip="true" aspectRatio="2" >
                        <p:ajax event="eventSelect" listener="#{calendarHome.onEventSelect}" oncomplete="editEvent();"/>
                        <p:ajax event="viewChange" listener="#{calendarHome.onViewChange}" />
                    </p:schedule>
                </h:form>

            </div>
        </div>

    </ui:define>

    <ui:define name="context-menu">
        <li>
            <p:commandLink id="newEvent"  action="#{calendarHome.newEvent}" >
                <f:param name="eventSource" value="simpleEventSource" />
                <h:graphicImage value="/img/ribbon/small/calendar.png" />
                <span>#{messages['calendar.button.SimpleEvent']}</span>
            </p:commandLink>
        </li>
        <li>
            <a href="#" onclick="PF('telveCalendar').jqc.fullCalendar('changeView', 'month');" >
                <h:graphicImage value="/img/ribbon/small/calendar_month.png" />
                <span >#{messages['calendar.button.Month']}</span> 
            </a>
        </li>
        <li>
            <a href="#" onclick="PF('telveCalendar').jqc.fullCalendar('changeView', 'agendaWeek');" >
                <h:graphicImage value="/img/ribbon/small/calendar_week.png" />
                <span >#{messages['calendar.button.Week']}</span> 
            </a>
        </li>
        <li>
            <a href="#" onclick="PF('telveCalendar').jqc.fullCalendar('changeView', 'agendaDay');" >
                <h:graphicImage value="/img/ribbon/small/calendar_day.png" />
                <span >#{messages['calendar.button.Day']}</span> 
            </a>
        </li>

        <ui:remove>
        <li>
            <a href="#" onclick="PF('calendarFilterPopup').show();" >
                <h:graphicImage value="/img/ribbon/small/calendar_group.png" />
                <span >#{messages['calendar.button.Filter']}</span> 
            </a>
        </li>
            </ui:remove>

        <li>
            <p:commandLink id="calb1" action="#{calendarFilterModel.toggleShowClosedEvent()}" update="calb1" process="@this" oncomplete="PF('telveCalendar').update();">
                <i class="fa #{calendarFilterModel.showClosedEvents ? 'fa-check-square' : 'fa-square' } " />
                #{messages['calendar.button.ShowClosed']}
            </p:commandLink>
        </li>

        <li>
            <p:commandLink id="calb2" action="#{calendarFilterModel.toggleShowPersonalEvents()}" update="calb2" process="@this" oncomplete="PF('telveCalendar').update();">
                <i class="fa #{calendarFilterModel.showPersonalEvents ? 'fa-check-square' : 'fa-square' } " />
                #{messages['calendar.button.ShowPOT']}
            </p:commandLink>
        </li>
    </ui:define>

    <ui:define name="content-list">
        <div class="box-header">
            <h4 class="box-title">#{messages['calendar.label.EventSources']}</h4>
        </div>

        <ul class="list-group">
            <ui:repeat value="#{calendarFilterModel.getRegisteredEventSources()}" var="es" >
                <li class="list-group-item"> 
                    <p:commandLink action="#{calendarFilterModel.toggleSelectSource(es)}" process="@this" update="@this" oncomplete="PF('telveCalendar').update();">
                        <i class="fa #{calendarFilterModel.getIsSourceSelected(es) ? 'fa-check-square-o' : 'fa-square-o'}" />
                    </p:commandLink>

                    <h:panelGroup id="cbtn" layout="span">

                        <button class="btn btn-sm #{calendarFilterModel.getSourceStyle(es)} dropdown-toggle" style="width: 14px; height: 16px;" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> 

                        </button>

                        <ui:remove>
                            <a href="#" class="dropdown-toggle #{calendarFilterModel.getSourceStyle(es)}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="caret"></span>
                            </a>
                        </ui:remove>
                        <ul class="dropdown-menu" >
                            <li><p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-blue')}"  process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-blue"></i> Mavi
                                </p:commandLink></li>
                            <li><p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-yellow')}"  process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-yellow"></i> Sarı

                                </p:commandLink></li>
                            <li><p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-red')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-red"></i> Kırmızı

                                </p:commandLink></li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-maroon')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-maroon"></i> Bordo

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-aqua')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-aqua"></i> Auqa

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-green')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-green"></i> Yeşil

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-light-blue')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-light-blue"></i> Açık Mavi

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-orange')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-orange"></i> Turuncu

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-olive')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-olive"></i> Zeytuni

                                </p:commandLink>
                            </li>
                            <li>
                                <p:commandLink action="#{calendarFilterModel.setSourceStyle(es, 'bg-purple')}" process="@this" update="cbtn" oncomplete="PF('telveCalendar').update();">
                                    <i class="fa fa-square text-purple"></i> Mor

                                </p:commandLink>
                            </li>
                        </ul>
                    </h:panelGroup>
                    #{messages[ 'calendar.source.name.'.concat( es ) ]} 

                </li>
            </ui:repeat>
        </ul>
    </ui:define>
</ui:composition>