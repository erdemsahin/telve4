<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:t="http://java.sun.com/jsf/composite/telveComponents"
                template="/layout/primeTemplate.xhtml">

    <ui:define name="outerspace">
        <ui:remove>
            <ui:include src="/layout/ajaxLoadingPopup.xhtml" />
        </ui:remove>
        <ui:insert name="includes" />
    </ui:define>

    <ui:define name="body">


        <ui:include src="/layout/messages.xhtml"/>

        <p:layout style="height:100%" >
            <p:layoutUnit position="west" size="300" header="#{messages['general.caption.List']}" collapsible="false" resizable="true" styleClass="panel-primary">
                <h:panelGroup id="treePanel" layout="block">
                    <h:form id="rtform">
                        <p:tree id="reportTree" value="#{reportHome.getRootNode()}" var="node"
                                selectionMode="single"
                                selection="#{reportHome.selectedData}" style="border: 0px; width: auto;">

                            <p:ajax event="select" listener="#{reportHome.onNodeSelect}" partialSubmit="true" process="@this" update=":rform"/>

                            <p:treeNode type="folder" expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
                                <h:outputText value="#{messages['report.folder.'.concat( node )]}"/>
                            </p:treeNode>

                            <p:treeNode type="JasperReport" expandedIcon="ui-icon-document" collapsedIcon="ui-icon-document">
                                <p:commandLink value="#{messages['report.name.'.concat( node )]}" title="#{messages['report.desc.'.concat( node )]}" action="#{reportHome.execReport(node)}" ajax="true" partialSubmit="true" process="@this"/>
                            </p:treeNode>

                        </p:tree>
                    </h:form>
                </h:panelGroup>
            </p:layoutUnit>

            <p:layoutUnit position="center" header="Favoriler" >
                <h:form id="rform">
                    <ui:fragment rendered="#{not reportHome.showReport}" >
                        <ui:repeat value="#{reportHome.getReportGroups().entrySet().toArray()}" var="group" varStatus="loop">
                            <t:accordion label="#{group.getKey()}" icon="ui-icon-home">
                                <div class="row">
                                    <ui:repeat value="#{group.getValue()}" var="item" varStatus="loop2">
                                        <div class="large-4 medium-6 small-12 columns end">
                                            <div class="row">
                                                <div class="large-2 medium-2 small-2 columns">
                                                    <p:commandLink action="#{reportHome.execReport(item)}" ajax="true" partialSubmit="true" process="@this">
                                                        <h:graphicImage value="#{reportHome.getIconPath(item)}" />
                                                    </p:commandLink>
                                                </div>
                                                <div class="large-10 medium-10 small-10 columns">
                                                    <div class="row">
                                                        <div class="large-12 medium-12 small-12 columns">
                                                            <p:commandLink value="#{messages['report.name.'.concat( item )]}" action="#{reportHome.execReport(item)}" ajax="true" partialSubmit="true" process="@this" style="font-weight: bold;">
                                                                <p:ajax event="dialogReturn"  listener="#{reportHome.onReportRun}" update=":rform" partialSubmit="true" process="@this"/>
                                                            </p:commandLink>
                                                        </div>
                                                        <div class="large-12 medium-12 small-12 columns">
                                                            #{messages['report.desc.'.concat( item )]} 
                                                        </div>
                                                        <div class="large-12 medium-12 small-12 columns">
                                                            <p:rating value="#{reportHome.reportRatings[ item ]}" converter="javax.faces.Integer">
                                                                <p:ajax event="rate" listener="#{reportHome.onrate}"  update=":rtform,:rform"/>
                                                                <p:ajax event="cancel" listener="#{reportHome.oncancel}" update=":rtform,:rform"/>
                                                            </p:rating>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ui:repeat>
                                </div>
                            </t:accordion>
                        </ui:repeat>
                    </ui:fragment>
                    
                    <ui:fragment rendered="#{reportHome.showReport}" >
                        <p:media player="pdf" value="#{reportHome.stream}" width="100%" height="100%">
                            Your browser can't display pdf, <a href="/resources/demo/media/guide.pdf">click</a> to download pdf instead.
                        </p:media>
                    </ui:fragment>
                </h:form>
            </p:layoutUnit>
        </p:layout>
    </ui:define>
</ui:composition>
